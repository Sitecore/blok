import { useCallback, useEffect, useState } from "react"

import {
  StreamMessages,
  streamMessagesClientsConfig,
} from "@/registry/new-york/stream/blocks/chat/stream-messages"
import { useGetChats } from "@/registry/new-york/stream/hooks/use-get-chats"

/* Token for the example to be able to work */
const token =
  "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IkZXZ2VHTFpCWGZJcjhKZy1ieDgxRSJ9.eyJodHRwczovL2F1dGguc2l0ZWNvcmVjbG91ZC5pby9jbGFpbXMvdGVuYW50X2lkIjoiODNmYTJhM2MtNTRhMi00OTY1LThlYmItMDhkZDQyMGVlN2M5IiwiaHR0cHM6Ly9hdXRoLnNpdGVjb3JlY2xvdWQuaW8vY2xhaW1zL3RlbmFudF9uYW1lIjoic3RyZWFtLWZydWl0ZnVsbC1kZXYtMDEiLCJzY19zeXNfaWQiOiI3MGYzZDY0OC0zYzU2LTRiMmEtYmU4Zi00ODdhOWI1ZDE3NGIiLCJodHRwczovL2F1dGguc2l0ZWNvcmVjbG91ZC5pby9jbGFpbXMvb3JnX2lkIjoib3JnX2IwN2lLRmpCMnpZaGk0OXAiLCJodHRwczovL2F1dGguc2l0ZWNvcmVjbG91ZC5pby9jbGFpbXMvdGVuYW50L01NU0VtYmVkZGVkVGVuYW50SUQiOiI5MzM5OGFmMS1iMjlhLTRhMzItOGViZC0wOGRkNDIwZWU3YzkiLCJodHRwczovL2F1dGguc2l0ZWNvcmVjbG91ZC5pby9jbGFpbXMvdGVuYW50L2VkaXRpb24iOiJwcmVtaXVtIiwiaHR0cHM6Ly9hdXRoLnNpdGVjb3JlY2xvdWQuaW8vY2xhaW1zL3RlbmFudC9DU0VtYmVkZGVkVGVuYW50SUQiOiIzYzMzZDQ5YS05MjlkLTQ1OGItNjQ5ZS0wOGRkYWQwNjJkYTkiLCJodHRwczovL2F1dGguc2l0ZWNvcmVjbG91ZC5pby9jbGFpbXMvb3JnX25hbWUiOiJhaS10ZWFtIiwiaHR0cHM6Ly9hdXRoLnNpdGVjb3JlY2xvdWQuaW8vY2xhaW1zL29yZ19kaXNwbGF5X25hbWUiOiJGcnVpdGZ1bCIsImh0dHBzOi8vYXV0aC5zaXRlY29yZWNsb3VkLmlvL2NsYWltcy9vcmdfYWNjb3VudF9pZCI6IjAwMDBERU1PQUNDT1VOVElEMCIsImh0dHBzOi8vYXV0aC5zaXRlY29yZWNsb3VkLmlvL2NsYWltcy9vcmdfdHlwZSI6ImludGVybmFsIiwic2Nfb3JnX3JlZ2lvbiI6ImV1dyIsImh0dHBzOi8vYXV0aC5zaXRlY29yZWNsb3VkLmlvL2NsYWltcy9lbWFpbCI6ImFudG9uaW9zLmxpYWtha2lzQHNpdGVjb3JlLmNvbSIsImh0dHBzOi8vYXV0aC5zaXRlY29yZWNsb3VkLmlvL2NsYWltcy9yb2xlcyI6WyJbT3JnYW5pemF0aW9uXVxcT3JnYW5pemF0aW9uIEFkbWluIl0sImh0dHBzOi8vYXV0aC5zaXRlY29yZWNsb3VkLmlvL2NsYWltcy9jbGllbnRfbmFtZSI6IlN0cmVhbSBVSSBEZXZlbG9wbWVudCBDbGllbnQiLCJpc3MiOiJodHRwczovL2F1dGgtc3RhZ2luZy0xLnNpdGVjb3JlLXN0YWdpbmcuY2xvdWQvIiwic3ViIjoiYXV0aDB8NjViY2U5MjhmNjhkZGNkMjQwYTc4ZmI0IiwiYXVkIjpbImh0dHBzOi8vYXBpLXN0YWdpbmcuc2l0ZWNvcmUtc3RhZ2luZy5jbG91ZCIsImh0dHBzOi8vb25lLXNjLXN0YWdpbmcuZXUuYXV0aDAuY29tL3VzZXJpbmZvIl0sImlhdCI6MTc1NjI4NzQzMywiZXhwIjoxNzU2MzczODMzLCJzY29wZSI6Im9wZW5pZCBwcm9maWxlIGVtYWlsIG9mZmxpbmVfYWNjZXNzIGJhY2tib25lLmV2ZW50czpyZWFkIGNvbm5lY3QudG9rZW5zOmNyZWF0ZSBjb25uZWN0LnBvcnRhbDpyZWFkIGNvbnNlbnQuY29uc2VudHM6ciBjb25zZW50LnVzcl9jb25zZW50czpyIGNvbnNlbnQudXNyX2NvbnNlbnRzOncgaWFtLnVzcjpyIGlhbS51c3I6dyBpYW0udXNyX29yZ3M6ciBwbGF0Zm9ybS5yZWdpb25zOmxpc3QgaWFtLm9yZzpyIGlhbS5vcmc6dyBpYW0ub3JnX2NvbnM6ciBpYW0ub3JnX2NvbnM6dyBpYW0ub3JnX2ludnM6ciBpYW0ub3JnX2ludnM6dyBpYW0ub3JnX2dycDpyIGlhbS5vcmdfZ3JwOncgaWFtLm9yZ19ncnBfbWJyczpyIGlhbS5vcmdfZ3JwX21icnM6dyBpYW0ub3JnX21icnM6ciBpYW0ub3JnX21icnM6dyBpYW0ub3JnX21icnNfcm9sZXM6dyBpYW0ucm9sZXM6ciBpYW0udXNyX3JvbGVzOnIgeG1jZGVwLmhzdDptbmcgeG1jZGVwLnBydjpyIHhtY2RlcC5wcnY6dyB4bWNkZXAuc2M6ciB4bWNkZXAuc2M6dyB4bWNsb3VkZGVwbG95LnByb2plY3RzOm1hbmFnZSB4bWNsb3VkZGVwbG95LmVudmlyb25tZW50czptYW5hZ2UgeG1jbG91ZGRlcGxveS5vcmdhbml6YXRpb25zOm1hbmFnZSB4bWNsb3VkZGVwbG95LmRlcGxveW1lbnRzOm1hbmFnZSB4bWNsb3VkZGVwbG95Lm1vbml0b3JpbmcuZGVwbG95bWVudHM6cmVhZCB4bWNsb3VkZGVwbG95LmNsaWVudHM6bWFuYWdlIHhtY2xvdWRkZXBsb3kuc291cmNlY29udHJvbDptYW5hZ2UgeG1jbG91ZGRlcGxveS5yaDptbmcgeG1jbG91ZGRlcGxveS5zaXRlOm1uZyB4bWNsb3VkLmNtOmFkbWluIHhtY2xvdWQuY206bG9naW4gcGxhdGZvcm0udGVuYW50czpsaXN0YWxsIGJhY2tib25lLmV2ZW50czplbmFibGUgYmFja2JvbmUuZXZlbnRzOmRpc2FibGUgdWkuZXh0ZW5zaW9uczpyZWFkIGVkZ2UudG9rZW5zOmNyZWF0ZSBlZGdlLnRva2VuczpyZWFkIGVkZ2UudG9rZW5zOmRlbGV0ZSBlZGdlLnRva2Vuczp1cGRhdGUgaGMubWdtbnQudHlwZXM6d3JpdGUgaGMubWdtbnQuYXBpa2V5czptYW5hZ2UgaGMubWdtbnQudHlwZXM6cmVhZCBoYy5tZ21udC5tZWRpYTptYW5hZ2UgaGMubWdtbnQuc3RhdGVzOnB1Ymxpc2ggaGMubWdtbnQuaXRlbXM6bWFuYWdlIGhjLm1nbW50LnVzZXJzOnJlYWQgaGMubWdtbnQuY2xpZW50czpyZWFkIGhjLm1nbW50LnRheG9ub21pZXM6cmVhZCBoYy5tZ21udC50YXhvbm9taWVzOndyaXRlIGhjLm1nbW50LmxvY2FsZXM6ciBoYy5tZ21udC5sb2NhbGVzOncgaGMubWdtbnQuc2V0dGluZ3M6ciBoYy5tZ21udC5zZXR0aW5nczptIG1tcy51cGxvYWQuZmlsZTphZGQgbW1zLnVwbG9hZC5maWxlOnJlbW92ZSBjbXAuc2l0ZXM6Y3JlYXRlIGNtcC5zaXRlczpyZWFkIGNtcC5jb2xsZWN0aW9uczpjcmVhdGUgY21wLmNvbGxlY3Rpb25zOnJlYWQgY21wLmNvbGxlY3Rpb25zOmRlbGV0ZSBjbXAuY29tcG9uZW50czpjcmVhdGUgY21wLmNvbXBvbmVudHM6cmVhZCBjbXAuY29tcG9uZW50czpkZWxldGUgY21wLmRhdGFzb3VyY2VzOmNyZWF0ZSBjbXAuZGF0YXNvdXJjZXM6cmVhZCBjbXAuZGF0YXNvdXJjZXM6ZGVsZXRlIGNtcC5zdHlsZXM6cmVhZCBjbXAuc3R5bGVzOnVwZGF0ZSBjbXAuc3R5bGVzOmRlbGV0ZSBjbXAucHJveHk6cmVhZCBjbXAuYmxvYnM6Y3JlYXRlIHN1cHBvcnQudGlja2V0czpjcmVhdGUgc2VhcmNoLnBvcnRhbDptYW5hZ2Ugc2VhcmNoLmRpc2NvdmVyOm1hbmFnZSBzZWFyY2guYWRtaW46bWFuYWdlIHNlYXJjaC5pbnRlcm5hbDptYW5hZ2Ugc2VhcmNoLnV0aWw6bWFuYWdlIHNlYXJjaC5hY2NvdW50Om1hbmFnZSBkaXNjb3Zlci5wb3J0YWw6bWFuYWdlIGRpc2NvdmVyLnNlYXJjaC1yZWM6bWFuYWdlIGRpc2NvdmVyLmFkbWluOm1hbmFnZSBkaXNjb3Zlci5pbnRlcm5hbDptYW5hZ2UgZGlzY292ZXIudXRpbDptYW5hZ2UgZGlzY292ZXIuZXZlbnQ6bWFuYWdlIGRpc2NvdmVyLmFjY291bnQ6bWFuYWdlIGZvcm1zLmVuZHBvaW50czpyZWFkIGZvcm1zLmVuZHBvaW50czpjcmVhdGUgZm9ybXMuZW5kcG9pbnRzOnVwZGF0ZSBmb3Jtcy5lbmRwb2ludHM6ZGVsZXRlIGZvcm1zLnN1Ym1pc3Npb25zOnJlYWQgZm9ybXMuc3VibWlzc2lvbnM6Y3JlYXRlIGZvcm1zLnN1Ym1pc3Npb25zOnVwZGF0ZSBmb3Jtcy5zdWJtaXNzaW9uczpkZWxldGUgZm9ybXMuZXhwb3J0czpjcmVhdGUgZm9ybXMuZXhwb3J0czpyZWFkIGF1ZGl0LmxvZ3M6ciBjb25uZWN0Lm9yZzpyIGNvbm5lY3Qub3JnLnRudDpyIGNvbm5lY3QucmNwOmMgY29ubmVjdC5yY3A6ciBjb25uZWN0LnJjcDp1IGNvbm5lY3QucmNwOmQgY29ubmVjdC5jb246YyBjb25uZWN0LmNvbjpyIGNvbm5lY3QuY29uOnUgY29ubmVjdC5jb246ZCBjb25uZWN0LmZsZHI6YyBjb25uZWN0LmZsZHI6ciBjb25uZWN0LmZsZHI6ZCBjb25uZWN0LmxjbC5pbXA6YyBjb25uZWN0LmxjbC5pbXA6ciBjb25uZWN0LmxjbC5leHA6YyBjb25uZWN0LmxjbC5leHA6ciBjb25uZWN0LnByb2o6ciBjb25uZWN0LnByb2o6ZCBjb25zZW50LmFwcF9jb25zZW50czpyIGNvbnNlbnQuYXBwX2NvbnNlbnRzOncgZXAuYWRtbi5vcmdzLmhzdG5tZTpyIGVwLmFkbW4ub3Jncy5oc3RubWU6dyBlcC51c3IuY3R4OnIgZXAudXNyLmN0eDp3IGVwLnVzci5jdHhfcmVzOnIgZXAudXNyLmN0eF9yZXM6dyB4bWFwcHMuY29udGVudDpnZW4gYWkub3JnLmJyZDpsIGFpLm9yZy5icmQ6ciBhaS5vcmcuYnJkOncgYWkub3JnLmVnOnIgYWkub3JnLmVnOncgYWkub3JnLmNodHM6ciBhaS5vcmcuY2h0czp3IGFpLm9yZy5kb2NzOnIgYWkub3JnLmRvY3M6dyBhaS5vcmcuYnJpOnIgYWkub3JnLmJyaTp3IGFpLmdlbi5jbXA6ciBhaS5nZW4uY21wOncgYWkucmVjLnZhcjp3IGFpLnJlYy52YXI6ciBhaS5yZWMuaHlwOncgYWkucmVjLmh5cDpyIGFpLm9yZzphZG1pbiBtbXMuZGVsaXZlcnk6ciBtbXMucHVibGljbGlua3M6ciBtbXMucHVibGljbGlua3M6dyBtbXMubWV0YWRhdGE6ciBjcy5hbGw6YWRtaW4geG1jcHViLnF1ZXVlOnIgeG1jcHViLmpvYnMuYTp3IHhtY3B1Yi5qb2JzLmE6ciB4bWNkYXRhLml0ZW1zLmE6ciBta3AuYXBwczpyIG1rcC5hcHBzOncgbWtwLmNsaWVudHM6ciBta3AuY2xpZW50czp3IG1rcC5hcHBpbnN0bHM6ciBta3AuYXBwaW5zdGxzOncgbWtwLnJlczpyIG1rcC50ZW5hbnQ6ciBta3AudGVuYW50OncgeG1jZGF0YS5wcnZkcy5hOnIgeG1jZGF0YS5wcnZkcy5hOnJjIHhtY2RhdGEucHJ2ZHMuYTpsIHhtY2RhdGEucHJ2ZHMuYTp3IiwiYXpwIjoiN1Q5U0tRUEtOa21vWEpWTWhEc2lWSHpOWGpmblNKdFQifQ.cvt7zriC-AYY-LhMjyh0KZXXYMTc29z1tsuqmNWqwjFto6BgMQCs-DODqeXGecwXLrm6SvqtVMDy3Xo9vCOtecrNYLmhUwIBkCpzx4M8bTgwZ0GY9BripAMXiH2wEyJ8cn9hrmWR-PajnzJP-gpp2_lIxYjpl1guuHrW_ypQyG0iSQ7L3Qyjq2Z7T_VmUXbcGwLvLp3HVaKo5AgOusSVVWOGb5cUNlSsOYmpo5zioXJ8qJ38dYBfVknN2fAOenH0lgO8Q31oLagzBKKXENdMjTVEK9QlnXumLhTvURyVqgdeX_6jcEsLVrKlQR1MGRcqrCWcCH2h4fKMkUXzh11kkQ"

/*
 * Initialize the clients below in order for the StreamMessages component to work properly
 */
streamMessagesClientsConfig(token, "euw", "dev") // !!!!!!!!!!! THIS IS MANDATORY !!!!!!!!!!!

export function StreamMessagesDemo() {
  const [chatId, setChatId] = useState("")
  const getChats = useGetChats(
    "org_b07iKFjB2zYhi49p",
    "auth0|65bce928f68ddcd240a78fb4"
  )

  const init = useCallback(async (): Promise<void> => {
    /* Get all available chats */
    const data = await getChats()

    /* Set a chat id */
    setChatId(data?.[0]?.id)
  }, [getChats])

  useEffect(() => {
    if (!chatId) init()
  }, [chatId, init])

  return (
    <StreamMessages
      session={{
        brandkitId: "2f669d68-d5ab-4664-944a-b1504a1a2a6c",
        userId: "auth0|65bce928f68ddcd240a78fb4",
        orgId: "org_b07iKFjB2zYhi49p",
        chatId: "e092c859-fce8-49be-b916-bf84477659d8",
        region: "euw",
        env: "dev",
        token,
      }}
    />
  )
}

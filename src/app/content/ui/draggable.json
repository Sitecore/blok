{
    "Default": "\"use client\";\n\nimport * as React from \"react\";\nimport { DndContext, type DragEndEvent, type UniqueIdentifier } from \"@/components/ui/dnd-context\";\nimport { DragOverlay } from \"@/components/ui/drag-overlay\";\nimport { Draggable } from \"@/components/ui/draggable\";\nimport { Droppable } from \"@/components/ui/droppable\";\nimport { Button } from \"@/components/ui/button\";\nimport { Move, CheckCircle2 } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\nexport default function BasicDragDrop() {\n  // Track which container the item is in: \"source\" or \"drop-zone\"\n  const [container, setContainer] = React.useState<\"source\" | \"drop-zone\">(\"source\");\n  const [activeId, setActiveId] = React.useState<UniqueIdentifier | null>(null);\n\n  const handleDragStart = ({ active }: { active: { id: UniqueIdentifier } }) => {\n    setActiveId(active.id);\n  };\n\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { over } = event;\n    setActiveId(null);\n    \n    if (over) {\n      // Move to whichever container it was dropped on\n      if (over.id === \"drop-zone\") {\n        setContainer(\"drop-zone\");\n      } else if (over.id === \"source\") {\n        setContainer(\"source\");\n      }\n    }\n    // If dropped outside any droppable, stay where it was\n  };\n\n  const handleDragCancel = () => {\n    setActiveId(null);\n  };\n\n  const draggableContent = (\n    <Button\n      className={cn(\n        \"w-full shadow-md hover:shadow-lg transition-all duration-200\",\n        \"bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary\"\n      )}\n      size=\"lg\"\n    >\n      <Move className=\"mr-2 h-4 w-4\" />\n      draggable\n    </Button>\n  );\n\n  return (\n    <DndContext\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n      onDragCancel={handleDragCancel}\n    >\n      <div className=\"p-6 space-y-6\">\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center gap-2\">\n            <h3 className=\"text-2xl font-semibold\">Basic Drag & Drop</h3>\n          </div>\n          <p className=\"text-sm text-muted-foreground\">\n            Drag the button between the source and drop zone areas.\n          </p>\n        </div>\n\n        <div className=\"flex flex-col md:flex-row gap-6 items-start\">\n          {/* Source Area - Now a Droppable */}\n          <div className=\"flex-shrink-0\">\n            <div className=\"mb-3 text-xs font-medium text-muted-foreground uppercase\">\n              Source\n            </div>\n            <Droppable\n              id=\"source\"\n              className={cn(\n                \"w-64 min-h-[140px] rounded-xl border-2 border-dashed p-4 transition-all duration-200\",\n                \"bg-gradient-to-br from-background to-muted/30 border-muted\",\n                \"data-[drop-target=true]:border-primary data-[drop-target=true]:bg-primary/5\"\n              )}\n            >\n              <div className=\"space-y-3 h-full flex flex-col justify-center\">\n                {container === \"source\" ? (\n                  <>\n                    <Draggable id=\"draggable-button\">\n                      {draggableContent}\n                    </Draggable>\n                    {!activeId && (\n                      <div className=\"flex items-center gap-2 text-xs text-muted-foreground justify-center\">\n                        <span>Drag me to the drop zone</span>\n                      </div>\n                    )}\n                  </>\n                ) : (\n                  <div className=\"text-center text-xs text-muted-foreground py-4\">\n                    <p>Drop here to return</p>\n                  </div>\n                )}\n              </div>\n            </Droppable>\n          </div>\n\n          {/* Drop Zone */}\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"mb-3 text-xs font-medium text-muted-foreground uppercase\">\n              Drop Zone\n            </div>\n            <Droppable\n              id=\"drop-zone\"\n              className={cn(\n                \"w-full min-h-[280px] rounded-xl border-2 border-dashed p-8 flex items-center justify-center transition-all duration-200\",\n                \"bg-gradient-to-br from-muted/20 to-muted/10\",\n                \"hover:from-muted/30 hover:to-muted/20\",\n                \"data-[drop-target=true]:border-primary data-[drop-target=true]:bg-primary/5 data-[drop-target=true]:shadow-lg data-[drop-target=true]:shadow-primary/10\"\n              )}\n            >\n              <div className=\"w-full h-full flex flex-col items-center justify-center gap-4\">\n                {container === \"drop-zone\" ? (\n                  <div className=\"text-center space-y-3 animate-in fade-in duration-300\">\n                    <div className=\"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center\">\n                      <CheckCircle2 className=\"h-8 w-8 text-primary\" />\n                    </div>\n                    <div>\n                      <p className=\"font-semibold text-sm\">Successfully Dropped!</p>\n                      <p className=\"text-xs text-muted-foreground mt-1\">\n                        Drag the button back to the source area\n                      </p>\n                    </div>\n                    <Draggable id=\"draggable-button\">\n                      {draggableContent}\n                    </Draggable>\n                  </div>\n                ) : (\n                  <div className=\"text-center space-y-3\">\n                    <div className=\"mx-auto w-16 h-16 rounded-full bg-muted flex items-center justify-center\">\n                      <Move className=\"h-8 w-8 text-muted-foreground\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium text-sm text-muted-foreground\">Drop Zone</p>\n                      <p className=\"text-xs text-muted-foreground mt-1\">\n                        Release the button here to drop it\n                      </p>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </Droppable>\n          </div>\n        </div>\n      </div>\n\n      {/* Drag Overlay for smooth animations */}\n      <DragOverlay>\n        {activeId ? draggableContent : null}\n      </DragOverlay>\n    </DndContext>\n  );\n}",
    "Basic Drag and Drop": "\"use client\";\n\nimport * as React from \"react\";\nimport { DndContext, type DragEndEvent, type UniqueIdentifier } from \"@/components/ui/dnd-context\";\nimport { DragOverlay } from \"@/components/ui/drag-overlay\";\nimport { Draggable } from \"@/components/ui/draggable\";\nimport { Droppable } from \"@/components/ui/droppable\";\nimport { Button } from \"@/components/ui/button\";\nimport { Move, CheckCircle2 } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\nexport default function BasicDragDrop() {\n  // Track which container the item is in: \"source\" or \"drop-zone\"\n  const [container, setContainer] = React.useState<\"source\" | \"drop-zone\">(\"source\");\n  const [activeId, setActiveId] = React.useState<UniqueIdentifier | null>(null);\n\n  const handleDragStart = ({ active }: { active: { id: UniqueIdentifier } }) => {\n    setActiveId(active.id);\n  };\n\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { over } = event;\n    setActiveId(null);\n    \n    if (over) {\n      // Move to whichever container it was dropped on\n      if (over.id === \"drop-zone\") {\n        setContainer(\"drop-zone\");\n      } else if (over.id === \"source\") {\n        setContainer(\"source\");\n      }\n    }\n    // If dropped outside any droppable, stay where it was\n  };\n\n  const handleDragCancel = () => {\n    setActiveId(null);\n  };\n\n  const draggableContent = (\n    <Button\n      className={cn(\n        \"w-full shadow-md hover:shadow-lg transition-all duration-200\",\n        \"bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary\"\n      )}\n      size=\"lg\"\n    >\n      <Move className=\"mr-2 h-4 w-4\" />\n      draggable\n    </Button>\n  );\n\n  return (\n    <DndContext\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n      onDragCancel={handleDragCancel}\n    >\n      <div className=\"p-6 space-y-6\">\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center gap-2\">\n            <h3 className=\"text-2xl font-semibold\">Basic Drag & Drop</h3>\n          </div>\n          <p className=\"text-sm text-muted-foreground\">\n            Drag the button between the source and drop zone areas.\n          </p>\n        </div>\n\n        <div className=\"flex flex-col md:flex-row gap-6 items-start\">\n          {/* Source Area - Now a Droppable */}\n          <div className=\"flex-shrink-0\">\n            <div className=\"mb-3 text-xs font-medium text-muted-foreground uppercase\">\n              Source\n            </div>\n            <Droppable\n              id=\"source\"\n              className={cn(\n                \"w-64 min-h-[140px] rounded-xl border-2 border-dashed p-4 transition-all duration-200\",\n                \"bg-gradient-to-br from-background to-muted/30 border-muted\",\n                \"data-[drop-target=true]:border-primary data-[drop-target=true]:bg-primary/5\"\n              )}\n            >\n              <div className=\"space-y-3 h-full flex flex-col justify-center\">\n                {container === \"source\" ? (\n                  <>\n                    <Draggable id=\"draggable-button\">\n                      {draggableContent}\n                    </Draggable>\n                    {!activeId && (\n                      <div className=\"flex items-center gap-2 text-xs text-muted-foreground justify-center\">\n                        <span>Drag me to the drop zone</span>\n                      </div>\n                    )}\n                  </>\n                ) : (\n                  <div className=\"text-center text-xs text-muted-foreground py-4\">\n                    <p>Drop here to return</p>\n                  </div>\n                )}\n              </div>\n            </Droppable>\n          </div>\n\n          {/* Drop Zone */}\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"mb-3 text-xs font-medium text-muted-foreground uppercase\">\n              Drop Zone\n            </div>\n            <Droppable\n              id=\"drop-zone\"\n              className={cn(\n                \"w-full min-h-[280px] rounded-xl border-2 border-dashed p-8 flex items-center justify-center transition-all duration-200\",\n                \"bg-gradient-to-br from-muted/20 to-muted/10\",\n                \"hover:from-muted/30 hover:to-muted/20\",\n                \"data-[drop-target=true]:border-primary data-[drop-target=true]:bg-primary/5 data-[drop-target=true]:shadow-lg data-[drop-target=true]:shadow-primary/10\"\n              )}\n            >\n              <div className=\"w-full h-full flex flex-col items-center justify-center gap-4\">\n                {container === \"drop-zone\" ? (\n                  <div className=\"text-center space-y-3 animate-in fade-in duration-300\">\n                    <div className=\"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center\">\n                      <CheckCircle2 className=\"h-8 w-8 text-primary\" />\n                    </div>\n                    <div>\n                      <p className=\"font-semibold text-sm\">Successfully Dropped!</p>\n                      <p className=\"text-xs text-muted-foreground mt-1\">\n                        Drag the button back to the source area\n                      </p>\n                    </div>\n                    <Draggable id=\"draggable-button\">\n                      {draggableContent}\n                    </Draggable>\n                  </div>\n                ) : (\n                  <div className=\"text-center space-y-3\">\n                    <div className=\"mx-auto w-16 h-16 rounded-full bg-muted flex items-center justify-center\">\n                      <Move className=\"h-8 w-8 text-muted-foreground\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium text-sm text-muted-foreground\">Drop Zone</p>\n                      <p className=\"text-xs text-muted-foreground mt-1\">\n                        Release the button here to drop it\n                      </p>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </Droppable>\n          </div>\n        </div>\n      </div>\n\n      {/* Drag Overlay for smooth animations */}\n      <DragOverlay>\n        {activeId ? draggableContent : null}\n      </DragOverlay>\n    </DndContext>\n  );\n}",
    "Sortable List": "\"use client\";\n\nimport * as React from \"react\";\nimport { DndContext, type DragEndEvent, SortableContainer, arrayMove, type UniqueIdentifier } from \"@/components/ui/dnd-context\";\nimport { SortableItem } from \"@/components/ui/sortable\";\nimport { DragOverlay } from \"@/components/ui/drag-overlay\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { cn } from \"@/lib/utils\";\n\ninterface Item {\n  id: number;\n  name: string;\n}\n\nexport default function SortableListDemo() {\n  const [items, setItems] = React.useState<Item[]>([\n    { id: 1, name: \"Design System\" },\n    { id: 2, name: \"API Integration\" },\n    { id: 3, name: \"User Testing\" },\n  ]);\n  const [activeId, setActiveId] = React.useState<UniqueIdentifier | null>(null);\n\n  const cardColors = [\n    \"bg-info-bg border-border\",\n    \"bg-success-bg border-border\",\n    \"bg-warning-bg border-border\",\n  ];\n\n  const handleDragStart = ({ active }: { active: { id: UniqueIdentifier } }) => {\n    setActiveId(active.id);\n  };\n\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event;\n    setActiveId(null);\n\n    if (over && active.id !== over.id) {\n      setItems((currentItems) => {\n        const oldIndex = currentItems.findIndex((item) => item.id === active.id);\n        const newIndex = currentItems.findIndex((item) => item.id === over.id);\n        return arrayMove(currentItems, oldIndex, newIndex);\n      });\n    }\n  };\n\n  const handleDragCancel = () => {\n    setActiveId(null);\n  };\n\n  const activeItem = activeId ? items.find((item) => item.id === activeId) : null;\n  const activeIndex = activeItem ? items.findIndex((item) => item.id === activeId) : -1;\n\n  return (\n    <DndContext\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n      onDragCancel={handleDragCancel}\n    >\n      <div className=\"p-6 space-y-6\">\n        <div>\n          <h3 className=\"text-2xl font-semibold\">Sortable List</h3>\n          <p className=\"text-sm text-muted-foreground mt-2\">\n            Drag items to reorder them in the list.\n          </p>\n        </div>\n\n        <div className=\"max-w-2xl\">\n          <SortableContainer items={items.map((item) => item.id)} strategy=\"vertical\">\n            <div className=\"space-y-2\">\n              {items.map((item, index) => (\n                <SortableItem\n                  key={item.id}\n                  id={item.id}\n                  className=\"transition-transform duration-200\"\n                >\n                  <Card className={cn(cardColors[index % cardColors.length], \"hover:shadow-sm transition-all duration-200\")}>\n                    <CardContent className=\"p-2.5\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"flex-shrink-0 w-5 h-5 rounded-full bg-card flex items-center justify-center text-[10px] font-semibold text-foreground\">\n                          {index + 1}\n                        </span>\n                        <p className=\"font-medium text-xs\">{item.name}</p>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </SortableItem>\n              ))}\n            </div>\n          </SortableContainer>\n        </div>\n      </div>\n\n      {/* Drag Overlay for smooth animations */}\n      <DragOverlay>\n        {activeItem && activeIndex >= 0 ? (\n          <Card className={cn(cardColors[activeIndex % cardColors.length], \"shadow-sm\")}>\n            <CardContent className=\"p-2.5\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"flex-shrink-0 w-5 h-5 rounded-full bg-card flex items-center justify-center text-[10px] font-semibold text-foreground\">\n                  {activeIndex + 1}\n                </span>\n                <p className=\"font-medium text-xs\">{activeItem.name}</p>\n              </div>\n            </CardContent>\n          </Card>\n        ) : null}\n      </DragOverlay>\n    </DndContext>\n  );\n}\n",
    "Custom Handle": "\"use client\";\n\nimport * as React from \"react\";\nimport { DndContext, type DragEndEvent, SortableContainer, arrayMove, type UniqueIdentifier } from \"@/components/ui/dnd-context\";\nimport { SortableItem, SortableHandle } from \"@/components/ui/sortable\";\nimport { DragOverlay } from \"@/components/ui/drag-overlay\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { GripVertical } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface Item {\n  id: string;\n  name: string;\n}\n\nfunction SortableCard({ item, cardColor }: { item: Item; cardColor: string }) {\n  return (\n    <SortableItem id={item.id} withHandle>\n      <Card className={cn(cardColor, \"group hover:shadow-sm transition-all duration-200\")}>\n        <CardContent className=\"p-2.5\">\n          <div className=\"flex items-center gap-2\">\n            <SortableHandle\n              className={cn(\n                \"flex-shrink-0 w-6 h-6 rounded flex items-center justify-center\",\n                \"bg-card hover:bg-muted\",\n                \"text-muted-foreground hover:text-foreground\",\n                \"transition-all duration-200\"\n              )}\n            >\n              <GripVertical className=\"h-3.5 w-3.5\" />\n            </SortableHandle>\n            <p className=\"font-medium text-xs\">{item.name}</p>\n          </div>\n        </CardContent>\n      </Card>\n    </SortableItem>\n  );\n}\n\nexport default function CustomHandleDemo() {\n  const [items, setItems] = React.useState<Item[]>([\n    { id: \"A\", name: \"Project Alpha\" },\n    { id: \"B\", name: \"Project Beta\" },\n    { id: \"C\", name: \"Project Gamma\" },\n  ]);\n  const [activeId, setActiveId] = React.useState<UniqueIdentifier | null>(null);\n\n  const cardColors = [\n    \"bg-info-bg border-border\",\n    \"bg-success-bg border-border\",\n    \"bg-warning-bg border-border\",\n  ];\n\n  const handleDragStart = ({ active }: { active: { id: UniqueIdentifier } }) => {\n    setActiveId(active.id);\n  };\n\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event;\n    setActiveId(null);\n\n    if (over && active.id !== over.id) {\n      setItems((currentItems) => {\n        const oldIndex = currentItems.findIndex((item) => item.id === active.id);\n        const newIndex = currentItems.findIndex((item) => item.id === over.id);\n        return arrayMove(currentItems, oldIndex, newIndex);\n      });\n    }\n  };\n\n  const handleDragCancel = () => {\n    setActiveId(null);\n  };\n\n  const activeItem = activeId ? items.find((item) => item.id === activeId) : null;\n  const activeIndex = activeItem ? items.findIndex((item) => item.id === activeId) : -1;\n\n  return (\n    <DndContext\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n      onDragCancel={handleDragCancel}\n    >\n      <div className=\"p-6 space-y-6\">\n        <div>\n          <h3 className=\"text-2xl font-semibold\">Custom Drag Handle</h3>\n          <p className=\"text-sm text-muted-foreground mt-2\">\n            Drag items using the grip icon handle only.\n          </p>\n        </div>\n\n        <div className=\"max-w-2xl\">\n          <SortableContainer items={items.map((item) => item.id)} strategy=\"vertical\">\n            <div className=\"space-y-2\">\n              {items.map((item, index) => (\n                <SortableCard\n                  key={item.id}\n                  item={item}\n                  cardColor={cardColors[index % cardColors.length]}\n                />\n              ))}\n            </div>\n          </SortableContainer>\n        </div>\n      </div>\n\n      {/* Drag Overlay for smooth animations */}\n      <DragOverlay>\n        {activeItem && activeIndex >= 0 ? (\n          <Card className={cn(cardColors[activeIndex % cardColors.length], \"shadow-sm\")}>\n            <CardContent className=\"p-2.5\">\n              <div className=\"flex items-center gap-2\">\n                <div\n                  className={cn(\n                    \"flex-shrink-0 w-6 h-6 rounded flex items-center justify-center\",\n                    \"cursor-grabbing\",\n                    \"bg-card\",\n                    \"text-foreground\"\n                  )}\n                >\n                  <GripVertical className=\"h-3.5 w-3.5\" />\n                </div>\n                <p className=\"font-medium text-xs\">{activeItem.name}</p>\n              </div>\n            </CardContent>\n          </Card>\n        ) : null}\n      </DragOverlay>\n    </DndContext>\n  );\n}\n",
    "Drag, Drop & Sort": "\"use client\";\n\nimport * as React from \"react\";\nimport {\n  DndContext,\n  type DragEndEvent,\n  type DragStartEvent,\n  SortableContainer,\n  arrayMove,\n  type UniqueIdentifier,\n  pointerWithin,\n  rectIntersection,\n} from \"@/components/ui/dnd-context\";\nimport type { CollisionDetection } from \"@dnd-kit/core\";\nimport { Draggable } from \"@/components/ui/draggable\";\nimport { Droppable } from \"@/components/ui/droppable\";\nimport { SortableItem } from \"@/components/ui/sortable\";\nimport { DragOverlay } from \"@/components/ui/drag-overlay\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Move } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface CardItem {\n  id: string;\n  name: string;\n}\n\nconst initialCards: CardItem[] = [\n  { id: \"card-1\", name: \"Design System\" },\n  { id: \"card-2\", name: \"API Integration\" },\n  { id: \"card-3\", name: \"User Testing\" },\n  { id: \"card-4\", name: \"Documentation\" },\n  { id: \"card-5\", name: \"Performance\" },\n];\n\nconst cardColors = [\n  \"bg-info-bg border-border\",\n  \"bg-success-bg border-border\",\n  \"bg-warning-bg border-border\",\n  \"bg-purple-50 dark:bg-purple-950/30 border-border\",\n  \"bg-pink-50 dark:bg-pink-950/30 border-border\",\n];\n\nfunction getCardColor(id: string) {\n  const index = initialCards.findIndex((c) => c.id === id);\n  return cardColors[index % cardColors.length];\n}\n\n// Custom collision detection that prioritizes items over containers\n// This ensures that when dragging over sortable items, they get detected first\nconst customCollisionDetection: CollisionDetection = (args) => {\n  // First, try pointerWithin to find items directly under the cursor\n  const pointerCollisions = pointerWithin(args);\n  \n  if (pointerCollisions.length > 0) {\n    // Filter to prioritize sortable items (cards) over containers\n    const itemCollisions = pointerCollisions.filter(\n      (collision) => \n        collision.id !== \"source-drop\" && \n        collision.id !== \"favorites-drop\"\n    );\n    \n    // If we're over a specific item, return that\n    if (itemCollisions.length > 0) {\n      return itemCollisions;\n    }\n    \n    // Otherwise return container collisions\n    return pointerCollisions;\n  }\n  \n  // Fallback to rectIntersection for edge cases\n  return rectIntersection(args);\n};\n\nfunction ItemCard({ item, index }: { item: CardItem; index?: number }) {\n  return (\n    <Card className={cn(getCardColor(item.id), \"hover:shadow-sm transition-all duration-200\")}>\n      <CardContent className=\"p-2.5\">\n        <div className=\"flex items-center gap-2\">\n          {index !== undefined && (\n            <span className=\"flex-shrink-0 w-5 h-5 rounded-full bg-card flex items-center justify-center text-[10px] font-semibold text-foreground\">\n              {index + 1}\n            </span>\n          )}\n          <p className=\"font-medium text-xs\">{item.name}</p>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function DragDropSortableDemo() {\n  // Cards that are available to drag (source pool)\n  const [sourceCards, setSourceCards] = React.useState<CardItem[]>(initialCards);\n  // Cards in the favorites list (sortable)\n  const [favoriteCards, setFavoriteCards] = React.useState<CardItem[]>([]);\n  // Currently dragging item\n  const [activeId, setActiveId] = React.useState<UniqueIdentifier | null>(null);\n  const [activeItem, setActiveItem] = React.useState<CardItem | null>(null);\n\n  const handleDragStart = (event: DragStartEvent) => {\n    const { active } = event;\n    setActiveId(active.id);\n    \n    // Find the item being dragged\n    const fromSource = sourceCards.find((c) => c.id === active.id);\n    const fromFavorites = favoriteCards.find((c) => c.id === active.id);\n    setActiveItem(fromSource || fromFavorites || null);\n  };\n\n  // Note: We intentionally don't modify state in handleDragOver to avoid infinite re-renders.\n  // All item transfers are handled in handleDragEnd.\n\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event;\n    setActiveId(null);\n    setActiveItem(null);\n\n    if (!over) return;\n\n    const activeId = active.id as string;\n    const overId = over.id as string;\n\n    const isFromSource = sourceCards.some((c) => c.id === activeId);\n    const isFromFavorites = favoriteCards.some((c) => c.id === activeId);\n    const isOverInFavorites = favoriteCards.some((c) => c.id === overId);\n    const isOverInSource = sourceCards.some((c) => c.id === overId);\n\n    // Handle sorting within favorites\n    if (isFromFavorites && isOverInFavorites && activeId !== overId) {\n      setFavoriteCards((prev) => {\n        const oldIndex = prev.findIndex((c) => c.id === activeId);\n        const newIndex = prev.findIndex((c) => c.id === overId);\n        return arrayMove(prev, oldIndex, newIndex);\n      });\n      return;\n    }\n\n    // Handle dropping from source to favorites (either container or item)\n    if (isFromSource && (overId === \"favorites-drop\" || isOverInFavorites)) {\n      const cardToMove = sourceCards.find((c) => c.id === activeId);\n      if (cardToMove) {\n        setSourceCards((prev) => prev.filter((c) => c.id !== activeId));\n        if (isOverInFavorites) {\n          // Insert at the position of the item we're hovering over\n          const overIndex = favoriteCards.findIndex((c) => c.id === overId);\n          setFavoriteCards((prev) => {\n            const newItems = [...prev];\n            newItems.splice(overIndex, 0, cardToMove);\n            return newItems;\n          });\n        } else {\n          // Append to the end\n          setFavoriteCards((prev) => [...prev, cardToMove]);\n        }\n      }\n      return;\n    }\n\n    // Handle dropping from favorites to source (either container or item)\n    if (isFromFavorites && (overId === \"source-drop\" || isOverInSource)) {\n      const cardToMove = favoriteCards.find((c) => c.id === activeId);\n      if (cardToMove) {\n        setFavoriteCards((prev) => prev.filter((c) => c.id !== activeId));\n        setSourceCards((prev) => [...prev, cardToMove]);\n      }\n      return;\n    }\n  };\n\n  const handleDragCancel = () => {\n    setActiveId(null);\n    setActiveItem(null);\n  };\n\n  // Get the index of the active item in favorites for the overlay\n  const activeIndexInFavorites = activeItem \n    ? favoriteCards.findIndex((c) => c.id === activeItem.id) \n    : -1;\n\n  return (\n    <DndContext\n      collisionDetection={customCollisionDetection}\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n      onDragCancel={handleDragCancel}\n    >\n      <div className=\"p-6 space-y-6\">\n        <div>\n          <h3 className=\"text-2xl font-semibold\">Drag, Drop & Sort</h3>\n          <p className=\"text-sm text-muted-foreground mt-2\">\n            Drag cards between panels. Reorder items in favorites by dragging.\n          </p>\n        </div>\n\n        <div className=\"flex flex-col lg:flex-row gap-6\">\n          {/* Source Cards Panel - Now Droppable */}\n          <div className=\"flex-1\">\n            <div className=\"mb-3 text-xs font-medium text-muted-foreground uppercase\">\n              Source\n            </div>\n            <Droppable\n              id=\"source-drop\"\n              className={cn(\n                \"p-4 rounded-xl border-2 border-dashed min-h-[200px] transition-all duration-200\",\n                \"bg-gradient-to-br from-background to-muted/30 border-muted\",\n                \"data-[drop-target=true]:border-primary data-[drop-target=true]:bg-primary/5\"\n              )}\n            >\n              {sourceCards.length > 0 ? (\n                <div className=\"space-y-2\">\n                  {sourceCards.map((card) => (\n                    <Draggable key={card.id} id={card.id}>\n                      <ItemCard item={card} />\n                    </Draggable>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"flex flex-col items-center justify-center h-full min-h-[150px] text-center\">\n                  <p className=\"text-sm font-medium text-muted-foreground\">No items</p>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    Drag items back here\n                  </p>\n                </div>\n              )}\n            </Droppable>\n          </div>\n\n          {/* Drop Zone Panel (Droppable + Sortable) */}\n          <div className=\"flex-1\">\n            <div className=\"mb-3 text-xs font-medium text-muted-foreground uppercase\">\n              Drop Zone\n            </div>\n            <Droppable\n              id=\"favorites-drop\"\n              className={cn(\n                \"p-4 rounded-xl border-2 border-dashed min-h-[200px] transition-all duration-200\",\n                \"bg-gradient-to-br from-muted/20 to-muted/10\",\n                \"hover:from-muted/30 hover:to-muted/20\",\n                \"data-[drop-target=true]:border-primary data-[drop-target=true]:bg-primary/5 data-[drop-target=true]:shadow-lg data-[drop-target=true]:shadow-primary/10\"\n              )}\n            >\n              {favoriteCards.length > 0 ? (\n                <SortableContainer items={favoriteCards.map((c) => c.id)} strategy=\"vertical\">\n                  <div className=\"space-y-2\">\n                    {favoriteCards.map((card, index) => (\n                      <SortableItem key={card.id} id={card.id}>\n                        <ItemCard item={card} index={index} />\n                      </SortableItem>\n                    ))}\n                  </div>\n                </SortableContainer>\n              ) : (\n                <div className=\"flex flex-col items-center justify-center h-full min-h-[150px] text-center space-y-3\">\n                  <div className=\"mx-auto w-12 h-12 rounded-full bg-muted flex items-center justify-center\">\n                    <Move className=\"h-6 w-6 text-muted-foreground\" />\n                  </div>\n                  <div>\n                    <p className=\"font-medium text-sm text-muted-foreground\">Drop Zone</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Drop items here and reorder them\n                    </p>\n                  </div>\n                </div>\n              )}\n            </Droppable>\n          </div>\n        </div>\n\n        {/* Instructions */}\n        <div className=\"text-xs text-muted-foreground bg-muted/50 rounded-lg p-3 space-y-1\">\n          <p><strong>Tips:</strong></p>\n          <ul className=\"list-disc list-inside space-y-0.5 ml-2\">\n            <li>Drag items from Source to Drop Zone</li>\n            <li>Drag items back from Drop Zone to Source</li>\n            <li>Reorder items in Drop Zone by dragging them</li>\n          </ul>\n        </div>\n      </div>\n\n      {/* Drag Overlay */}\n      <DragOverlay>\n        {activeItem ? (\n          <Card className={cn(getCardColor(activeItem.id), \"shadow-sm\")}>\n            <CardContent className=\"p-2.5\">\n              <div className=\"flex items-center gap-2\">\n                {activeIndexInFavorites >= 0 && (\n                  <span className=\"flex-shrink-0 w-5 h-5 rounded-full bg-card flex items-center justify-center text-[10px] font-semibold text-foreground\">\n                    {activeIndexInFavorites + 1}\n                  </span>\n                )}\n                <p className=\"font-medium text-xs\">{activeItem.name}</p>\n              </div>\n            </CardContent>\n          </Card>\n        ) : null}\n      </DragOverlay>\n    </DndContext>\n  );\n}\n"
}